"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[118],{1118:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var r=n(6540),a=n(9785),l=n(893),o=n(7767),i=n(1083),c=n(4476),u=c.z.object({id:c.z.number(),quantity:c.z.number().optional()}),s=c.z.object({id:c.z.number(),tag:c.z.string({message:"A tag is required"}),color:c.z.string()}),m=c.z.object({id:c.z.number().optional(),name:c.z.string({message:"The Item name is required"}),description:c.z.string().optional(),containerItems:c.z.array(u).optional(),tags:c.z.array(s).optional()}),d=c.z.object({scannerId:c.z.string().optional(),quantity:c.z.number().positive({message:"Quantity must be positive"}).optional(),linkId:c.z.number().optional()}).optional(),p=c.z.object({item:m,links:c.z.array(d)});const f=function(e){var t=e.control,n=e.name,l=e.onDelete,o=(0,a.as)({control:t,name:n}),i=o.field;return o.fieldState,r.createElement("div",{className:"d-inline-flex badge rounded-pill align-items-center",style:{backgroundColor:i.value.color}},r.createElement("span",{style:{color:i.value.color,mixBlendMode:"multiply",paddingRight:10,whiteSpace:"nowrap"}},i.value.tag),r.createElement("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:l}))};var b=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function o(e){try{c(r.next(e))}catch(e){l(e)}}function i(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((r=r.apply(e,t||[])).next())}))},v=function(e,t){var n,r,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,i[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};const h=function(e){var t=e.control,n=e.name,l=(0,r.useState)("#FF0000"),o=l[0],c=l[1],u=(0,r.useState)(""),s=u[0],m=u[1],d=(0,r.useState)(""),p=d[0],h=d[1],y=(0,a.jz)({control:t,name:n,keyName:"key"}),g=y.fields,E=y.append,k=y.remove;return r.createElement("div",null,r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"tagInput",className:"form-label"},"Tags"),r.createElement("div",{className:"input-group"},r.createElement("input",{onChange:function(e){return m(e.target.value)},type:"text",value:s,id:"tagInput",className:"form-control w-75"}),r.createElement("input",{type:"color",className:"form-control form-control-color",id:"colorInput",value:o,onChange:function(e){return c(e.target.value)}}),r.createElement("button",{onClick:function(){return b(void 0,void 0,void 0,(function(){var e,t;return v(this,(function(n){switch(n.label){case 0:if(0===s.length)return h("The tag must have a value"),[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,i.A.post("/api/tags/create",{id:void 0,tag:s,color:o})];case 2:return e=n.sent().data,E(e),m(""),h(""),[3,4];case 3:return t=n.sent(),console.error(t),[3,4];case 4:return[2]}}))}))},type:"button",className:"btn btn-warning"},"Add")),r.createElement("div",{className:"form-text text-info"},p)),g.map((function(e,n){return r.createElement(f,{key:"tag-".concat(e.key),control:t,name:"item.tags.".concat(n),onDelete:function(){return function(e){return b(void 0,void 0,void 0,(function(){return v(this,(function(t){try{k(e)}catch(e){console.error(e)}return[2]}))}))}(n)}})})))};var y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},y.apply(this,arguments)},g=function(e,t,n,r){return new(n||(n=Promise))((function(a,l){function o(e){try{c(r.next(e))}catch(e){l(e)}}function i(e){try{c(r.throw(e))}catch(e){l(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,i)}c((r=r.apply(e,t||[])).next())}))},E=function(e,t){var n,r,a,l,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,i[0]&&(o=0)),o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}};function k(){var e,t,n,c=this,u=(0,o.zy)(),s=(0,o.Zp)(),m=null===(e=u.state)||void 0===e?void 0:e.response,d=(0,a.mN)({defaultValues:m?{item:m.item,links:m.links}:{item:{},links:[{quantity:1}]},resolver:(0,l.u)(p)}),f=d.register,b=d.handleSubmit,v=d.formState,k=v.errors,w=v.isSubmitting,N=d.control,z=d.reset,I=(0,a.jz)({control:N,name:"links"}),x=I.fields,S=I.append,C=I.remove,j=(0,a.FH)({control:N,name:"links"});return(0,r.useEffect)((function(){var e,t,n;(null===(e=null==j?void 0:j[j.length-1])||void 0===e?void 0:e.scannerId)&&(S({scannerId:"",quantity:1}),setTimeout((function(){var e;null===(e=document.getElementById("linkId-".concat(j.length-1)))||void 0===e||e.focus()}),0)),(null==j?void 0:j.length)>1&&!(null===(t=null==j?void 0:j[j.length-2])||void 0===t?void 0:t.scannerId)&&!(null===(n=null==j?void 0:j[j.length-1])||void 0===n?void 0:n.scannerId)&&C(j.length-1)}),[j]),r.createElement("div",{className:"d-flex justify-content-center align-items-center"},r.createElement("form",{className:"w-75 p-3",onSubmit:b((function(e){return g(c,void 0,void 0,(function(){return E(this,(function(t){switch(t.label){case 0:return m?[4,i.A.patch("/api/item/edit",e)]:[3,2];case 1:return t.sent(),s(-1),[3,4];case 2:return[4,i.A.post("/api/item/create",e)];case 3:t.sent(),z(),t.label=4;case 4:return[2]}}))}))}),(function(e){console.log("Validation Errors: ",e)}))},r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"nameInput",className:"form-label"},"Name"),r.createElement("input",y({},f("item.name"),{type:"text",id:"nameInput",className:"form-control",placeholder:"Item Name"})),(null===(t=k.item)||void 0===t?void 0:t.name)&&r.createElement("p",null,"".concat(k.item.name.message))),r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"descriptionTextArea",className:"form-label"},"Description"),r.createElement("textarea",y({},f("item.description"),{id:"descriptionTextArea",className:"form-control",placeholder:"Item Description"})),(null===(n=k.item)||void 0===n?void 0:n.description)&&r.createElement("p",null,"".concat(k.item.description.message))),r.createElement(h,{control:N,name:"item.tags"}),r.createElement("table",{id:"linkTable",className:"table table-secondary table-hover table-striped"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"}),r.createElement("th",{scope:"col"},"Scanner ID"),r.createElement("th",{scope:"col"},"Quantity"),r.createElement("th",{scope:"col"},"Remove"))),r.createElement("tbody",{id:"linkTableBody",className:"link"},x.map((function(e,t){var n;return r.createElement("tr",{key:e.id,"data-key":e.id},r.createElement("th",null,t+1),r.createElement("td",null,r.createElement("input",y({},f("links.".concat(t,".scannerId")),{id:"linkId-".concat(t),className:"form-control",defaultValue:e.scannerId}))),r.createElement("td",null,r.createElement("input",y({},f("links.".concat(t,".quantity"),{valueAsNumber:!0}),{className:"form-control",defaultValue:e.quantity}))),r.createElement("td",null,r.createElement("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:function(){return function(e,t){return g(c,void 0,void 0,(function(){var n;return E(this,(function(r){switch(r.label){case 0:if(void 0===t)return C(e),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,i.A.delete("/api/link?id=".concat(t))];case 2:return r.sent(),C(e),[3,4];case 3:return n=r.sent(),console.error("Error deleting link: ",n),[3,4];case 4:return[2]}}))}))}(t,e.linkId)}})),k.links&&k.links[t]&&r.createElement("p",null,null===(n=k.links[t])||void 0===n?void 0:n.message))})))),r.createElement("button",{type:"submit",className:"btn btn-primary",disabled:w},m?"Update":"Create")))}}}]);