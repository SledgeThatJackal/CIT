"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[118],{1118:(e,t,n)=>{n.r(t),n.d(t,{default:()=>w});var r=n(6540),a=n(9785),o=n(893),l=n(7767),c=n(1083),i=n(4476),s=i.z.object({id:i.z.number(),quantity:i.z.number().optional()}),u=i.z.object({id:i.z.number(),tag:i.z.string({message:"A tag is required"}),color:i.z.string()}),m=i.z.object({id:i.z.number().optional(),name:i.z.string({message:"The Item name is required"}),description:i.z.string().optional(),containerItems:i.z.array(s).optional(),tags:i.z.array(u).optional()}),d=i.z.object({scannerId:i.z.string().optional(),quantity:i.z.number().positive({message:"Quantity must be positive"}).optional(),linkId:i.z.number().optional()}).optional(),p=i.z.object({item:m,links:i.z.array(d)});const f=function(e){var t=e.control,n=e.name,o=e.onDelete,l=(0,a.as)({control:t,name:n}),c=l.field,i=(l.fieldState,c.value.color.replace("#","")),s=(16711422&parseInt(i,16))>>1,u="#".concat(s.toString(16).padStart(6,"0"));return r.createElement("div",{className:"d-inline-flex badge rounded-pill align-items-center",style:{backgroundColor:c.value.color,border:"3px solid ".concat(u),marginRight:3}},r.createElement("span",{style:{color:u,paddingRight:10,whiteSpace:"nowrap"}},c.value.tag),r.createElement("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:o}))};var b=n(8917),v=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function l(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,c)}i((r=r.apply(e,t||[])).next())}))},h=function(e,t){var n,r,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(l=0)),l;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,r=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){l=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){l.label=c[1];break}if(6===c[0]&&l.label<a[1]){l.label=a[1],a=c;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(c);break}a[2]&&l.ops.pop(),l.trys.pop();continue}c=t.call(e,l)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};const g=function(e){var t=e.control,n=e.name,o=(0,r.useState)("#FF0000"),l=o[0],i=o[1],s=(0,r.useState)(""),u=s[0],m=s[1],d=(0,r.useState)(""),p=d[0],g=d[1],y=(0,r.useState)([]),E=y[0],k=y[1],w=(0,a.jz)({control:t,name:n,keyName:"key"}),N=w.fields,I=w.append,z=w.remove;(0,r.useEffect)((function(){v(void 0,void 0,void 0,(function(){var e,t;return h(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,c.A.get("/api/tags")];case 1:return e=n.sent().data,k(e),[3,3];case 2:return t=n.sent(),console.log("Request failed: ",t),[3,3];case 3:return[2]}}))}))}),[N]);var x=function(e){return v(void 0,void 0,void 0,(function(){var t,n;return h(this,(function(r){switch(r.label){case 0:return console.log("Add Tag"),e?(t=e,[3,4]):[3,1];case 1:return r.trys.push([1,3,,4]),console.log("Try"),0===u.length?(g("The tag must have a value"),[2]):[4,c.A.post("/api/tags/create",{id:void 0,tag:u,color:l})];case 2:return t=r.sent().data,console.log("newTag"),[3,4];case 3:return n=r.sent(),console.error(n),[2];case 4:return I(t),m(""),g(""),[2]}}))}))};return r.createElement("div",null,r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"tagInput",className:"form-label"},"Tags"),r.createElement("div",{className:"input-group"},r.createElement("input",{onChange:function(e){return m(e.target.value)},type:"text",value:u,id:"tagInput",className:"form-control w-75 dropdown-toggle dropdown-toggle-split","data-bs-toggle":"dropdown","aria-expanded":"false","data-bs-reference":"parent"}),r.createElement("div",{className:"dropdown-menu","aria-labeled":"tagInput"},E.length>0&&E.filter((function(e){var t=u.toLowerCase(),n=e.tag.toLowerCase();return!(t.length>0&&!n.startsWith(t)||N.some((function(e){return e.tag.toLowerCase()===n})))})).map((function(e,t){return r.createElement("button",{key:"db-tags-".concat(t),type:"button",className:"drowndown-item",onClick:function(){return x(e)},style:{border:0,backgroundColor:"white"}},r.createElement(b.A,{tag:e}))}))),r.createElement("input",{type:"color",className:"form-control form-control-color",id:"colorInput",value:l,onChange:function(e){return i(e.target.value)}}),r.createElement("button",{onClick:function(){return x()},type:"button",className:"btn btn-warning"},"Add")),r.createElement("div",{className:"form-text text-info"},p)),N.map((function(e,n){return r.createElement(f,{key:"tag-".concat(e.key),control:t,name:"item.tags.".concat(n),onDelete:function(){return function(e){return v(void 0,void 0,void 0,(function(){return h(this,(function(t){try{z(e)}catch(e){console.error(e)}return[2]}))}))}(n)}})})))};var y=function(){return y=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},y.apply(this,arguments)},E=function(e,t,n,r){return new(n||(n=Promise))((function(a,o){function l(e){try{i(r.next(e))}catch(e){o(e)}}function c(e){try{i(r.throw(e))}catch(e){o(e)}}function i(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,c)}i((r=r.apply(e,t||[])).next())}))},k=function(e,t){var n,r,a,o,l={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(c){return function(i){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,c[0]&&(l=0)),l;)try{if(n=1,r&&(a=2&c[0]?r.return:c[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,c[1])).done)return a;switch(r=0,a&&(c=[2&c[0],a.value]),c[0]){case 0:case 1:a=c;break;case 4:return l.label++,{value:c[1],done:!1};case 5:l.label++,r=c[1],c=[0];continue;case 7:c=l.ops.pop(),l.trys.pop();continue;default:if(!((a=(a=l.trys).length>0&&a[a.length-1])||6!==c[0]&&2!==c[0])){l=0;continue}if(3===c[0]&&(!a||c[1]>a[0]&&c[1]<a[3])){l.label=c[1];break}if(6===c[0]&&l.label<a[1]){l.label=a[1],a=c;break}if(a&&l.label<a[2]){l.label=a[2],l.ops.push(c);break}a[2]&&l.ops.pop(),l.trys.pop();continue}c=t.call(e,l)}catch(e){c=[6,e],r=0}finally{n=a=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,i])}}};function w(){var e,t,n,i=this,s=(0,l.zy)(),u=(0,l.Zp)(),m=null===(e=s.state)||void 0===e?void 0:e.response,d=(0,a.mN)({defaultValues:m?{item:m.item,links:m.links}:{item:{},links:[{quantity:1}]},resolver:(0,o.u)(p)}),f=d.register,b=d.handleSubmit,v=d.formState,h=v.errors,w=v.isSubmitting,N=d.control,I=d.reset,z=(0,a.jz)({control:N,name:"links"}),x=z.fields,S=z.append,C=z.remove,T=(0,a.FH)({control:N,name:"links"});return(0,r.useEffect)((function(){var e,t,n;(null===(e=null==T?void 0:T[T.length-1])||void 0===e?void 0:e.scannerId)&&(S({scannerId:"",quantity:1}),setTimeout((function(){var e;null===(e=document.getElementById("linkId-".concat(T.length-1)))||void 0===e||e.focus()}),0)),(null==T?void 0:T.length)>1&&!(null===(t=null==T?void 0:T[T.length-2])||void 0===t?void 0:t.scannerId)&&!(null===(n=null==T?void 0:T[T.length-1])||void 0===n?void 0:n.scannerId)&&C(T.length-1)}),[T]),r.createElement("div",{className:"d-flex justify-content-center align-items-center"},r.createElement("form",{className:"w-75 p-3",onSubmit:b((function(e){return E(i,void 0,void 0,(function(){return k(this,(function(t){switch(t.label){case 0:return m?[4,c.A.patch("/api/item/edit",e)]:[3,2];case 1:return t.sent(),u(-1),[3,4];case 2:return[4,c.A.post("/api/item/create",e)];case 3:t.sent(),I(),t.label=4;case 4:return[2]}}))}))}),(function(e){console.log("Validation Errors: ",e)}))},r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"nameInput",className:"form-label"},"Name"),r.createElement("input",y({},f("item.name"),{type:"text",id:"nameInput",className:"form-control",placeholder:"Item Name",autoFocus:!0})),(null===(t=h.item)||void 0===t?void 0:t.name)&&r.createElement("p",null,"".concat(h.item.name.message))),r.createElement("div",{className:"mb-3"},r.createElement("label",{htmlFor:"descriptionTextArea",className:"form-label"},"Description"),r.createElement("textarea",y({},f("item.description"),{id:"descriptionTextArea",className:"form-control",placeholder:"Item Description"})),(null===(n=h.item)||void 0===n?void 0:n.description)&&r.createElement("p",null,"".concat(h.item.description.message))),r.createElement(g,{control:N,name:"item.tags"}),r.createElement("table",{id:"linkTable",className:"table table-secondary table-hover table-striped"},r.createElement("thead",null,r.createElement("tr",null,r.createElement("th",{scope:"col"}),r.createElement("th",{scope:"col"},"Scanner ID"),r.createElement("th",{scope:"col"},"Quantity"),r.createElement("th",{scope:"col"},"Remove"))),r.createElement("tbody",{id:"linkTableBody",className:"link"},x.map((function(e,t){var n;return r.createElement("tr",{key:e.id,"data-key":e.id},r.createElement("th",null,t+1),r.createElement("td",null,r.createElement("input",y({},f("links.".concat(t,".scannerId")),{id:"linkId-".concat(t),className:"form-control",defaultValue:e.scannerId}))),r.createElement("td",null,r.createElement("input",y({},f("links.".concat(t,".quantity"),{valueAsNumber:!0}),{className:"form-control",defaultValue:e.quantity}))),r.createElement("td",null,r.createElement("button",{type:"button",className:"btn-close","aria-label":"Close",onClick:function(){return function(e,t){return E(i,void 0,void 0,(function(){var n;return k(this,(function(r){switch(r.label){case 0:if(void 0===t)return C(e),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,c.A.delete("/api/link?id=".concat(t))];case 2:return r.sent(),C(e),[3,4];case 3:return n=r.sent(),console.error("Error deleting link: ",n),[3,4];case 4:return[2]}}))}))}(t,e.linkId)}})),h.links&&h.links[t]&&r.createElement("p",null,null===(n=h.links[t])||void 0===n?void 0:n.message))})))),r.createElement("button",{type:"submit",className:"btn btn-primary",disabled:w},m?"Update":"Create")))}}}]);